<ion-content>
  <div class="header">
    <ion-toolbar style="--background: transparent; opacity: 0.7;">
      <ion-buttons slot="start">
        <ion-button (click)="back()" fill="clear" shape="round">
          <ion-icon slot="icon-only" name="arrow-back"></ion-icon>
        </ion-button>
      </ion-buttons>
      <ion-buttons slot="end">
        <ion-button (click)="onClick()" fill="clear" shape="round">
          <ion-icon slot="icon-only" name="share-social"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
  </div>
  <div class="flex">
    <ion-card style="height: 320px;width: 180px;" class="ion-no-margin">
      <ion-img [src]="url" style="height: 320px;width: 180px;"></ion-img>
    </ion-card>
  </div>
  <h1 class="ion-text-center ion-no-margin">{{firebase.book.name}}</h1>
  <div class="subscribe ion-no-margin">
    <p>
      {{firebase.book.view}}<ion-icon name="eye"></ion-icon>
    </p>
    <div class="ion-margin">
      <ion-icon name="star" *ngFor="let i of firebase.book.starsArray" color="primary"></ion-icon>
    </div>
    <p color="light" mode="ios">
      {{firebase.book.vote}}<ion-icon name="chatbubble"></ion-icon>
    </p>
  </div>
  <div class="subscribe">
    <ion-chip color="primary" mode="ios" outline="true" *ngFor="let author of authors">
      <ion-label>{{author.name}}</ion-label>
    </ion-chip>
  </div>
  <ion-text color="medium" class="ion-text-center">
  <p>{{firebase.book.desc}}</p>
  </ion-text>
  <ion-text color="primary" class="ion-text-center">
    <p>En savoir plus</p>
  </ion-text>
  <div class="subscribe">
    <ion-badge color="primary" mode="ios" *ngFor="let tag of firebase.book.tags">
      {{tag}}
    </ion-badge>
  </div>
  <div class="subscribe">
    <ion-button (click)="play()" expand="block" fill="solid" shape="round">
      <ion-icon name="play"></ion-icon>
      Lire
    </ion-button>
  </div>
  <div class="subscribe">
    <!-- <ion-button (click)="play()" expand="block" fill="solid" shape="round">
      Continuer de lire
    </ion-button> -->
    <ion-button (click)="edit()" expand="block" fill="clear" shape="round" *ngIf="isAuthor()" color="medium">
      <ion-icon name="create"></ion-icon>
      Editer
    </ion-button>
    <ion-button (click)="addToList(firebase.book.id)" expand="block" fill="clear" shape="round" *ngIf="!isAuthor() && !inList" color="medium">
      <ion-icon name="list"></ion-icon>
      Ajouter Ã  la liste
    </ion-button>
    <ion-button (click)="removeFromList(firebase.book.id)" expand="block" fill="clear" shape="round" *ngIf="!isAuthor() && inList" color="medium">
      <ion-icon name="list"></ion-icon>
      Retirer de la liste
    </ion-button>
  </div>
  <ion-card>
    <ion-item lines="none">
      <ion-avatar slot="start" style="width: 50px; height: 50px;">
        <ion-img [src]="firebase.userData.avatar" (click)="changeAvatar()" button ></ion-img>
      </ion-avatar>
      <ion-buttons>
        <ion-button *ngFor="let star of [0,0,0,0,0]; index as i" [color]="getStarColor(i)" (click)="setRate(i)">
          <ion-icon slot="icon-only" name="star"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-item>
    <ion-item lines="none">
      <ion-textarea [(ngModel)]="comment.text" placeholder="Laisser un avis" (keypress)="enter($event.keyCode)"></ion-textarea>
      <ion-button (click)="send()" expand="block" fill="clear" shape="round" slot="end">
        <ion-icon slot="icon-only" name="send"></ion-icon>
      </ion-button>
    </ion-item>
  </ion-card>
  <ion-grid fixed>
    <ion-row *ngFor="let comment of firebase.comments">
      <ion-col>
        <ion-avatar style="width: 50px; height: 50px;">
          <ion-img [src]="firebase.userData.avatar" (click)="changeAvatar()" button ></ion-img>
        </ion-avatar>
      </ion-col>
      <ion-col size="10">
        <ion-card>
          <ion-item lines="none">
            <ion-label color="primary" slot="start">
                Pseudonyme<br>
                <ion-icon name="star" *ngFor="let i of starToArray(comment.rate)" color="primary"></ion-icon>
            </ion-label>
            <ion-note slot="end" class="ion-text-end">
              {{comment.date|timeAgo}} 
            </ion-note>
          </ion-item>
          <ion-item lines="none">
            <p>
              <ion-text color="medium">
                {{comment.text}}
              </ion-text>
            </p>
          </ion-item>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>
  
</ion-content>


